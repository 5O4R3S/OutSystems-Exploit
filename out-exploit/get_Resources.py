from colorama import Fore, Style
import re
import commons

keys_not_allowed = r"(/css/|/scripts/|/fonts/|/img/|/moduleservices/)"

def get_all_resources(data,environment_url):
    print(f"{Fore.WHITE}{Style.BRIGHT}[i] {commons.get_current_datetime()} Searching for public resources files...{Style.RESET_ALL}")

    # Extract a list of available "urlVersions"
    url_mappings = data["manifest"]["urlVersions"]
    
    # Access the dictionary keys created above
    for key in url_mappings.keys():
        if not re.search(keys_not_allowed, key):
            # Print resources files founded
            print(f"| {Fore.WHITE}{Style.DIM}[200] {environment_url}{key}{Style.RESET_ALL}")
